---
/* eslint max-lines: 'off' */
import NavPagination from '../components/NavPagination.astro';
import ShowEntity from '../vue/components/ShowEntity.vue';
import ProductHeader from '../vue/components/ProductHeader.vue';

// get data
const headers = [
	 '程序名称',
	 '程序ID',
	 '备注',
	 '版本号',
	 '密钥'
 ]

// 定义传递给 ProductHeader 的属性
const headerProps = {
  title: "应用管理",
  buttonText: "添加新应用",
  showSearch: true,
  searchPlaceholder: "搜索应用..."
}
---

<entities-crud type="products">
	<ProductHeader 
		client:load 
		{...headerProps}
	/>
	
	<ShowEntity 
		client:load 
		headers={headers} 
	/>

	<NavPagination />
	
</entities-crud>

<script>
	// 定义事件处理函数
	function handleAdd() {
		window.productStore.showAddDialog = true;
	}

	function handleSearch(event) {
		const searchQuery = event.detail;
		console.log('搜索关键词:', searchQuery);
		// 这里添加你的搜索逻辑
	}

	// 添加事件监听
	document.addEventListener('DOMContentLoaded', () => {
		const productHeader = document.querySelector('entities-crud');
		if (productHeader) {
			// 使用自定义事件监听			
			productHeader.addEventListener('search', handleSearch);
			productHeader.addEventListener('add', handleAdd);
		}
	});
</script>
