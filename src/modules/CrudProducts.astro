---
/* eslint max-lines: 'off' */
import ShowEntity from '../vue/components/ShowEntity.vue';
import ProductHeader from '../vue/components/ProductHeader.vue';
import NavPagination from '../vue/components/NavPagination.vue';

// get data
const headers = [
   '程序名称',
   '程序ID',
   '备注', 
   '版本号',
   '密钥'
]

// 定义表单字段
const formFields = [
  {
    key: 'sname',
    label: '程序名称', 
    type: 'text',
    required: true,
    placeholder: '请输入程序名称'
  },
  {
    key: 'sdesc',
    label: '备注',
    type: 'textarea', 
    rows: 3,
    placeholder: '请输入备注信息'
  },
  {
    key: 'sversion',
    label: '版本号',
    type: 'text',
    placeholder: '请输入版本号'
  }
]

// 定义传递给 ProductHeader 的属性
const headerProps = {
  title: "应用管理",
  buttonText: "添加新应用",
  showSearch: true,
  searchPlaceholder: "搜索应用...",
  formFields
}
---

<entities-crud type="products">
  <ProductHeader 
    client:load 
    {...headerProps}
  />
  
  <ShowEntity 
    client:load 
    headers={headers} 
  />

  <NavPagination 
    client:load
    total={100}
    current={1} 
    last={10}
    onPageChange="handlePageChange"
  />
  
</entities-crud>

<script>
  // 定义事件处理函数
  function handleAdd(event) {
    const formData = event.detail;
    alert('添加新应用：' + JSON.stringify(formData));
  }

  function handleSearch(event) {
    const searchQuery = event.detail;
    alert('搜索关键词:' + searchQuery);
  }

  // 添加分页切换处理函数
  function handlePageChange(event) {
    const newPage = event.detail;
    alert(`切换到第 ${newPage} 页`);
  }

  // 添加事件监听
  document.addEventListener('DOMContentLoaded', () => {
    const productHeader = document.querySelector('entities-crud');
    if (productHeader) {
      productHeader.addEventListener('search', handleSearch);
      productHeader.addEventListener('add', handleAdd);
      productHeader.addEventListener('pageChange', handlePageChange);
    }
  });
</script>
